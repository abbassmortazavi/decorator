<?php


use Illuminate\Support\Facades\App;
use Illuminate\Support\Facades\Crypt;

if (!function_exists('base_is_mobile')) {
    /**
     * @return false|int
     */
    function base_is_mobile(): bool|int
    {
        return preg_match("/(android|avantgo|blackberry|bolt|boost|cricket|docomo|fone|hiptop|mini|mobi|palm|phone|pie|tablet|up\.browser|up\.link|webos|wos)/i", $_SERVER['HTTP_USER_AGENT']);
    }
}

if (!function_exists('base_i18n_set_name')) {
    /**
     * if language is farsi or arabic file should be with .rtl
     *
     * @param $fileName
     * @param null $locale
     * @return mixed
     */
    function base_i18n_set_name($fileName, $locale = null): mixed
    {
        $locale = is_null($locale) ? App::getLocale() : $locale;

        if ($locale == 'fa' || $locale == 'ar') {
            $array = explode('.', $fileName);
            $ext = @end($array);

            if (strlen($ext) > 3) {
                return $fileName;
            }

            if (!str_contains($fileName, '.')) {
                return $fileName;
            }

            if (str_contains($fileName, '.min.')) {
                return str_replace('.min.', '.rtl.min.', $fileName);
            } else {
                return str_replace('.' . $ext, '.rtl.' . $ext, $fileName);
            }
        }

        return $fileName;
    }
}

if (!function_exists('base_i18n_persian_optimize')) {
    /**
     * tart Convert (e) Arabic 2 (e) Standard Persian
     * @param $text
     * @return mixed|string
     */
    function base_i18n_persian_optimize($text): string
    {
        $text = str_replace('&#1740;', 'ÛŒ', $text);
        $text = str_replace('Ùƒ', 'Ú©', $text);
        $text = str_replace('ÙŠ', 'ÛŒ', $text);     //new!!!
        $text = str_replace('&#65265; ', 'Ù‰ ', $text);
        $text = str_replace('&#65266; ', 'Ù‰ ', $text);
        $text = str_replace('\"', '"', $text);

        $from = $to = [];
        $from[] = ['Ø†', 'Ø‡', 'Øˆ', 'Ø‰', 'ØŠ', 'Ø', 'Ø', 'Ø', 'Ø‘', 'Ø’', 'Ø“', 'Ø”', 'Ø•',
            'Ø–', 'Ø˜', 'Ø™', 'Øš', 'Ø', 'Ù–', 'Ù—', 'Ù˜', 'Ù™', 'Ùš', 'Ù›', 'Ùœ', 'Ù', 'Ù', 'ÙŸ', 'Ùª',
            'Ù¬', 'Ù­', 'Û', 'Û‚', 'Ûƒ', 'Û”', 'Û–', 'Û—', 'Û˜', 'Û™', 'Ûš', 'Û›', 'Ûœ', 'Û', 'ÛŸ', 'Û ',
            'Û¡', 'Û¢', 'Û£', 'Û¤', 'Û¥', 'Û¦', 'Û§', 'Û¨', 'Û©', 'Ûª', 'Û«', 'Û¬', 'Û­', 'Û®', 'Û¯', 'ï®§',
            'ï®²', 'ï®³', 'ï®´', 'ï®µ', 'ï®¶', 'ï®·', 'ï®¸', 'ï®¹', 'ï®º', 'ï®»', 'ï®¼', 'ï®½', 'ï®¾', 'ï®¿', 'ï¯€', 'ï¯', 'ï±',
            'ï±Ÿ', 'ï± ', 'ï±¡', 'ï±¢', 'ï±£', 'ï¹°', 'ï¹±', 'ï¹²', 'ï¹³', 'ï¹´', 'ï¹¶', 'ï¹·', 'ï¹¸', 'ï¹¹', 'ï¹º', 'ï¹»', 'ï¹¼', 'ï¹½',
            'ï¹¾', 'ï¹¿',];
        $to[] = '';
        $from[] = ['Ø£', 'Ø¥', 'Ù±', 'Ù²', 'Ù³', 'Ùµ', 'İ³', 'İ´', 'ï­', 'ï­‘', 'ïºƒ', 'ïº„', 'ïº‡', 'ïºˆ',
            'ïº', 'ïº', 'ğº€', 'ï´¼', 'ï´½', 'ğ¸€',];
        $to[] = 'Ø§';
        $from[] = ['Ù®', 'İ•', 'İ–', 'ï­’', 'ï­“', 'ï­”', 'ï­•', 'ïº', 'ïº', 'ïº‘', 'ïº’', 'ğ¸', 'ğ¸œ',
            'ğ¸¡', 'ğ¹¡', 'ğ¹¼', 'ğº', 'ğº¡',];
        $to[] = 'Ø¨';
        $from[] = ['Ú€', 'İ', 'İ”', 'ï­–', 'ï­—', 'ï­˜', 'ï­™', 'ï­š', 'ï­›', 'ï­œ', 'ï­'];
        $to[] = 'Ù¾';
        $from[] = ['Ù¹', 'Ùº', 'Ù»', 'Ù¼', 'İ“', 'ï­', 'ï­Ÿ', 'ï­ ', 'ï­¡', 'ï­¢', 'ï­£', 'ï­¤', 'ï­¥',
            'ï­¦', 'ï­§', 'ï­¨', 'ï­©', 'ïº•', 'ïº–', 'ïº—', 'ïº˜', 'ğ¸•', 'ğ¸µ', 'ğ¹µ', 'ğº•', 'ğºµ',];
        $to[] = 'Øª';
        $from[] = ['Ù½', 'Ù¿', 'İ‘', 'ïº™', 'ïºš', 'ïº›', 'ïºœ', 'ğ¸–', 'ğ¸¶', 'ğ¹¶', 'ğº–', 'ğº¶'];
        $to[] = 'Ø«';
        $from[] = ['Úƒ', 'Ú„', 'ï­²', 'ï­³', 'ï­´', 'ï­µ', 'ï­¶', 'ï­·', 'ï­¸', 'ï­¹', 'ïº', 'ïº', 'ïºŸ',
            'ïº ', 'ğ¸‚', 'ğ¸¢', 'ğ¹‚', 'ğ¹¢', 'ğº‚', 'ğº¢',];
        $to[] = 'Ø¬';
        $from[] = ['Ú‡', 'Ú¿', 'İ˜', 'ï­º', 'ï­»', 'ï­¼', 'ï­½', 'ï­¾', 'ï­¿', 'ï®€', 'ï®',
            'ğ¸ƒ', 'ğºƒ',];
        $to[] = 'Ú†';
        $from[] = ['Ú', 'İ®', 'İ¯', 'İ²', 'İ¼', 'ïº¡', 'ïº¢', 'ïº£', 'ïº¤', 'ğ¸‡', 'ğ¸§', 'ğ¹‡', 'ğ¹§',
            'ğº‡', 'ğº§',];
        $to[] = 'Ø­';
        $from[] = ['Ú‚', 'Ú…', 'İ—', 'ïº¥', 'ïº¦', 'ïº§', 'ïº¨', 'ğ¸—', 'ğ¸·', 'ğ¹—', 'ğ¹·', 'ğº—', 'ğº·'];
        $to[] = 'Ø®';
        $from[] = ['Úˆ', 'Ú‰', 'ÚŠ', 'ÚŒ', 'Ú', 'Ú', 'Ú', 'Ú', 'İ™', 'İš', 'ïº©', 'ïºª', 'ğº£', 'ï®‚',
            'ï®ƒ', 'ï®ˆ', 'ï®‰',];
        $to[] = 'Ø¯';
        $from[] = ['ï±›', 'ï±', 'ïº«', 'ïº¬', 'ğ¸˜', 'ğº˜', 'ğº¸', 'ï®„', 'ï®…', 'ï®†', 'ï®‡'];
        $to[] = 'Ø°';
        $from[] = ['Ù«', 'Ú‘', 'Ú’', 'Ú“', 'Ú”', 'Ú•', 'Ú–', 'İ›', 'İ¬', 'ï®Œ', 'ï®', 'ï±œ', 'ïº­', 'ïº®',
            'ğ¸“', 'ğº“', 'ğº³',];
        $to[] = 'Ø±';
        $from[] = ['Ú—', 'Ú™', 'İ«', 'İ±', 'ïº¯', 'ïº°', 'ğ¸†', 'ğº†', 'ğº¦'];
        $to[] = 'Ø²';
        $from[] = ['ï®Š', 'ï®‹', 'Ú˜'];
        $to[] = 'Ú˜';
        $from[] = ['Úš', 'İ½', 'İ¾', 'ïº±', 'ïº²', 'ïº³', 'ïº´', 'ğ¸', 'ğ¸®', 'ğ¹', 'ğ¹®', 'ğº', 'ğº®'];
        $to[] = 'Ø³';
        $from[] = ['Ú›', 'Ûº', 'İœ', 'İ­', 'İ°', 'ïºµ', 'ïº¶', 'ïº·', 'ïº¸', 'ğ¸”', 'ğ¸´', 'ğ¹”', 'ğ¹´',
            'ğº”', 'ğº´',];
        $to[] = 'Ø´';
        $from[] = ['Ú', 'ïº¹', 'ïºº', 'ïº»', 'ïº¼', 'ğ¸‘', 'ğ¹‘', 'ğ¸±', 'ğ¹±', 'ğº‘', 'ğº±'];
        $to[] = 'Øµ';
        $from[] = ['Ú', 'Û»', 'ïº½', 'ïº¾', 'ïº¿', 'ï»€', 'ğ¸™', 'ğ¸¹', 'ğ¹™', 'ğ¹¹', 'ğº™', 'ğº¹'];
        $to[] = 'Ø¶';
        $from[] = ['ï»', 'ï»‚', 'ï»ƒ', 'ï»„', 'ğ¸ˆ', 'ğ¹¨', 'ğºˆ', 'ğº¨'];
        $to[] = 'Ø·';
        $from[] = ['ÚŸ', 'ï»…', 'ï»†', 'ï»‡', 'ï»ˆ', 'ğ¸š', 'ğ¹º', 'ğºš', 'ğºº'];
        $to[] = 'Ø¸';
        $from[] = ['Ø', 'Ú ', 'ï»‰', 'ï»Š', 'ï»‹', 'ï»Œ', 'ğ¸', 'ğ¸¯', 'ğ¹', 'ğ¹¯', 'ğº', 'ğº¯'];
        $to[] = 'Ø¹';
        $from[] = ['Û¼', 'İ', 'İ', 'İŸ', 'ï»', 'ï»', 'ï»', 'ï»', 'ğ¸›', 'ğ¸»', 'ğ¹›', 'ğ¹»', 'ğº›',
            'ğº»',];
        $to[] = 'Øº';
        $from[] = ['Ø‹', 'Ú¡', 'Ú¢', 'Ú£', 'Ú¤', 'Ú¥', 'Ú¦', 'İ ', 'İ¡', 'ï­ª', 'ï­«', 'ï­¬', 'ï­­',
            'ï­®', 'ï­¯', 'ï­°', 'ï­±', 'ï»‘', 'ï»’', 'ï»“', 'ï»”', 'ğ¸', 'ğ¸', 'ğ¸°', 'ğ¹°', 'ğ¹¾', 'ğº', 'ğº°',];
        $to[] = 'Ù';
        $from[] = ['Ù¯', 'Ú§', 'Ú¨', 'ï»•', 'ï»–', 'ï»—', 'ï»˜', 'ğ¸’', 'ğ¸Ÿ', 'ğ¸²', 'ğ¹’', 'ğ¹Ÿ', 'ğ¹²',
            'ğº’', 'ğº²', 'Øˆ',];
        $to[] = 'Ù‚';
        $from[] = ['Ø»', 'Ø¼', 'Ùƒ', 'Úª', 'Ú«', 'Ú¬', 'Ú­', 'Ú®', 'İ¢', 'İ£', 'İ¤', 'İ¿', 'ï®',
            'ï®', 'ï®', 'ï®‘', 'ï¯“', 'ï¯”', 'ï¯•', 'ï¯–', 'ï»™', 'ï»š', 'ï»›', 'ï»œ', 'ğ¸Š', 'ğ¸ª', 'ğ¹ª',];
        $to[] = 'Ú©';
        $from[] = ['Ú°', 'Ú±', 'Ú²', 'Ú³', 'Ú´', 'ï®’', 'ï®“', 'ï®”', 'ï®•', 'ï®–', 'ï®—', 'ï®˜', 'ï®™', 'ï®š',
            'ï®›', 'ï®œ', 'ï®',];
        $to[] = 'Ú¯';
        $from[] = ['Úµ', 'Ú¶', 'Ú·', 'Ú¸', 'İª', 'ï»', 'ï»', 'ï»Ÿ', 'ï» ', 'ğ¸‹', 'ğ¸«', 'ğ¹‹', 'ğº‹',
            'ğº«',];
        $to[] = 'Ù„';
        $from[] = ['Û¾', 'İ¥', 'İ¦', 'ï»¡', 'ï»¢', 'ï»£', 'ï»¤', 'ğ¸Œ', 'ğ¸¬', 'ğ¹¬', 'ğºŒ', 'ğº¬'];
        $to[] = 'Ù…';
        $from[] = ['Ú¹', 'Úº', 'Ú»', 'Ú¼', 'Ú½', 'İ§', 'İ¨', 'İ©', 'ï®', 'ï®Ÿ', 'ï® ', 'ï®¡', 'ï»¥', 'ï»¦',
            'ï»§', 'ï»¨', 'ğ¸', 'ğ¸', 'ğ¸­', 'ğ¹', 'ğ¹', 'ğ¹­', 'ğº', 'ğº­',];
        $to[] = 'Ù†';
        $from[] = ['Ø¤', 'Ù¶', 'Ù·', 'Û„', 'Û…', 'Û†', 'Û‡', 'Ûˆ', 'Û‰', 'ÛŠ', 'Û‹', 'Û', 'İ¸', 'İ¹',
            'ï¯—', 'ï¯˜', 'ï¯™', 'ï¯š', 'ï¯›', 'ï¯œ', 'ï¯', 'ï¯', 'ï¯Ÿ', 'ï¯ ', 'ï¯¡', 'ï¯¢', 'ï¯£', 'ïº…', 'ïº†', 'ï»­', 'ï»®',
            'ğ¸…', 'ğº…', 'ğº¥',];
        $to[] = 'Ùˆ';
        $from[] = ['Ø©', 'Ú¾', 'Û€', 'Û•', 'Û¿', 'ï®¤', 'ï®¥', 'ï®¦', 'ï®©', 'ï®¨', 'ï®ª', 'ï®«', 'ï®¬', 'ï®­',
            'ïº“', 'ïº”', 'ï»©', 'ï»ª', 'ï»«', 'ï»¬', 'ğ¸¤', 'ğ¹¤', 'ğº„',];
        $to[] = 'Ù‡';
        $from[] = ['Ø ', 'Ø½', 'Ø¾', 'Ø¿', 'Ù‰', 'ÙŠ', 'Ù¸', 'Û', 'Û', 'Û', 'Û‘', 'Û’', 'Û“',
            'İµ', 'İ¶', 'İ·', 'İº', 'İ»', 'ï®¢', 'ï®£', 'ï®®', 'ï®¯', 'ï®°', 'ï®±', 'ï¯¤', 'ï¯¥', 'ï¯¦', 'ï¯§', 'ï¯¨',
            'ï¯©', 'ï¯¼', 'ï¯½', 'ï¯¾', 'ï¯¿', 'ïº‰', 'ïºŠ', 'ïº‹', 'ïºŒ', 'ï»¯', 'ï»°', 'ï»±', 'ï»²', 'ï»³', 'ï»´', 'ğ¸‰', 'ğ¸©',
            'ğ¹‰', 'ğ¹©', 'ğº‰', 'ğº©',];
        $to[] = 'ÛŒ';
        $from[] = ['Ù´', 'Û½', 'ïº€'];
        $to[] = 'Ø¡';
        $from[] = ['ï»µ', 'ï»¶', 'ï»·', 'ï»¸', 'ï»¹', 'ï»º', 'ï»»', 'ï»¼'];
        $to[] = 'Ù„Ø§';
        $from[] = ['ï·²', 'ï·¼', 'ï·³', 'ï·´', 'ï·µ', 'ï·¶', 'ï··', 'ï·¸',
            'ï·¹', 'ï·º', 'ï·»',];
        $to[] = ['Ø§Ù„Ù„Ù‡', 'Ø±ÛŒØ§Ù„', 'Ø§Ú©Ø¨Ø±', 'Ù…Ø­Ù…Ø¯', 'ØµÙ„Ø¹Ù…', 'Ø±Ø³ÙˆÙ„', 'Ø¹Ù„ÛŒÙ‡', 'ÙˆØ³Ù„Ù…',
            'ØµÙ„ÛŒ', 'ØµÙ„ÛŒ Ø§Ù„Ù„Ù‡ Ø¹Ù„ÛŒÙ‡ ÙˆØ³Ù„Ù…', 'Ø¬Ù„ Ø¬Ù„Ø§Ù„Ù‡',];

        for ($i = 0; $i < count($from); $i++) {
            $text = str_replace($from[$i], $to[$i], $text);
        }

        return $text;
    }
}

if (!function_exists('base_i18n_global_to_local_url')) {

    function base_i18n_global_to_local_url($text = null)
    {
        if (is_null($text)) {
            return $text;
        }

        $storage_folder = '/image/original'; //!empty(config('filer.folder')) ? config('filer.folder') : 'storage/uploads';
        $base_url_from = url('/') . $storage_folder;
        $base_url_to = $storage_folder;
        $text = str_replace($base_url_from, $base_url_to, $text);

        return $text;
    }
}

if (!function_exists('base_i18n_local_to_global_url')) {

    /**
     * @param $text
     * @return array|mixed|string|string[]|null
     */
    function base_i18n_local_to_global_url($text = null)
    {
        if (is_null($text)) {
            return $text;
        }

        $base_url_from = $storage_folder = '/image/original'; //!empty(config('filer.folder')) ? config('filer.folder') : 'storage/uploads';
        $base_url_to = url('/') . $base_url_from;
        return str_replace($base_url_from, $base_url_to, $text);
    }
}

if (!function_exists('base_convert_numbers')) {
    /**
     * @param $string
     * @param $locale
     * @return string|array
     */
    function base_convert_numbers($string, $locale = null): string|array
    {
        $locale = is_null($locale) ? App::getLocale() : $locale;
        $invalid_array = ['&#1632;' => '0', '&#1633;' => '1', '&#1634;' => '2', '&#1635;' => '3', '&#1636;' => '4', '&#1637;' => '5', '&#1638;' => '6', '&#1639;' => '7', '&#1640;' => '8', '&#1641;' => '9'];
        $farsi_array = ['Û°', 'Û±', 'Û²', 'Û³', 'Û´', 'Ûµ', 'Û¶', 'Û·', 'Û¸', 'Û¹'];

        $english_array = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];
        return $locale == 'fa' ?
            str_replace($english_array, $farsi_array, $string) :
            strtr($string, ['Û°' => '0', 'Û±' => '1', 'Û²' => '2', 'Û³' => '3', 'Û´' => '4', 'Ûµ' => '5', 'Û¶' => '6', 'Û·' => '7', 'Û¸' => '8', 'Û¹' => '9', 'Ù ' => '0', 'Ù¡' => '1', 'Ù¢' => '2', 'Ù£' => '3', 'Ù¤' => '4', 'Ù¥' => '5', 'Ù¦' => '6', 'Ù§' => '7', 'Ù¨' => '8', 'Ù©' => '9']);

    }
}

if (!function_exists('base_str_slug_i18n')) {
    function base_str_slug_i18n($string, $sep = '-'): string
    {
        $string = trim($string);
        $flip = $sep == '-' ? '_' : '-';
        $string = preg_replace('![' . preg_quote($flip) . ']+!u', $sep, $string);
        $string = preg_replace('![^' . preg_quote($sep) . '\pL\pN\s]+!u', '', mb_strtolower($string));
        $string = preg_replace('![' . preg_quote($sep) . '\s]+!u', $sep, $string);

        return trim($string, $sep);
    }
}

